<html> 
<head> 
  <meta charset="utf-8" /> 
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" /> 
  <meta name="theme-color" content="#111827" /> 
  <title>Memo PWA (Menu)</title> 
 
  <style> 
    :root{ 
      --bg:#0b1220; 
      --panel:#111827; 
      --panel2:#0f172a; 
      --text:#e5e7eb; 
      --muted:#94a3b8; 
      --line:#1f2937; 
      --accent:#60a5fa; 
      --warn:#f59e0b; 
      --hit:#fde047; 
 
      --safe-b: env(safe-area-inset-bottom, 0px); 
      --safe-t: env(safe-area-inset-top, 0px); 
 
      --menu-h: 54px; 
      --bottom-h: 84px;   /* Status/log minimum */ 
      --radius: 12px; 
      --pad: 12px; 
      --font: 16px; 
      --lh: 1.5; 
    } 
 
    *{ box-sizing:border-box; } 
    html,body{ height:100%; } 
    body{ 
      margin:0; 
      background:var(--bg); 
      color:var(--text); 
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; 
      padding-top: var(--safe-t); 
    } 
 
    /* ====== Menu Bar ====== */ 
    .menubar{ 
      position:fixed; 
      left:0; right:0; 
      top: var(--safe-t); 
      height: var(--menu-h); 
      padding: 8px var(--pad); 
      display:flex; 
      align-items:center; 
      gap:10px; 
      background: rgba(11,18,32,0.96); 
      border-bottom: 1px solid var(--line); 
      z-index: 50; 
    } 
    .menu-group{ position:relative; } 
    .menu-btn{ 
      appearance:none; 
      border:1px solid var(--line); 
      background: var(--panel2); 
      color: var(--text); 
      padding: 8px 12px; 
      border-radius: 10px; 
      min-height: 38px; 
      font-size: 14px; 
    } 
    .menu-btn:active{ transform: translateY(1px); } 
    .menu-panel{ 
      position:absolute; 
      top: 44px; 
      left: 0; 
      width: 220px; 
      background: rgba(17,24,39,0.98); 
      border:1px solid var(--line); 
      border-radius: var(--radius); 
      padding: 6px; 
      display:none; 
      box-shadow: 0 10px 30px rgba(0,0,0,0.35); 
    } 
    .menu-panel.open{ display:block; } 
 
    .menu-item{ 
      width:100%; 
      text-align:left; 
      appearance:none; 
      border:0; 
      background: transparent; 
      color: var(--text); 
      padding: 10px 10px; 
      border-radius: 10px; 
      font-size: 14px; 
      min-height: 44px; 
    } 
    .menu-item:hover{ background: rgba(96,165,250,0.10); } 
    .menu-item:active{ transform: translateY(1px); } 
    .menu-sep{ 
      height:1px; 
      background: var(--line); 
      margin: 6px 6px; 
    } 
 
    .menubar-right{ 
      margin-left:auto; 
      display:flex; 
      align-items:center; 
      gap:10px; 
      min-width:0; 
    } 
    .note-title{ 
      color: var(--muted); 
      font-size: 12px; 
      max-width: 40vw; 
      overflow:hidden; 
      text-overflow: ellipsis; 
      white-space: nowrap; 
    } 
    .status{ 
      color: var(--muted); 
      font-size:12px; 
      white-space:nowrap; 
    } 
 
    /* ====== Editor (highlight + textarea overlay) ====== */ 
    .editor-wrap{ 
      position:fixed; 
      inset: 
        calc(var(--menu-h) + var(--safe-t)) 
        0 
        calc(var(--bottom-h) + var(--safe-b)) 
        0; 
      padding: var(--pad); 
    } 
    .editor-surface{ 
      position:relative; 
      height:100%; 
      border:1px solid var(--line); 
      border-radius: var(--radius); 
      overflow:hidden; 
      background:#0a1020; 
    } 
 
    #highlightLayer{ 
      position:absolute; 
      inset:0; 
      margin:0; 
      padding: 14px; 
      font-size: var(--font); 
      line-height: var(--lh); 
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Courier New", monospace; 
      white-space: pre-wrap; 
      word-break: break-word; 
      overflow:auto; 
      color: transparent; 
      pointer-events:none; 
    } 
    #highlightLayer .hit{ 
      background: var(--hit); 
      color: transparent; 
      border-radius: 4px; 
    } 
    #highlightLayer .active{ 
      outline: 2px solid var(--warn); 
      outline-offset: -2px; 
    } 
 
    #editor{ 
      position:absolute; 
      inset:0; 
      width:100%; 
      height:100%; 
      margin:0; 
      padding: 14px; 
      border:0; 
      outline:none; 
      resize:none; 
      background: transparent; 
      color: var(--text); 
      font-size: var(--font); 
      line-height: var(--lh); 
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Courier New", monospace; 
      overflow:auto; 
      -webkit-overflow-scrolling: touch; 
      caret-color: var(--accent); 
    } 
 
    /* Wrap OFF */ 
    .nowrap #highlightLayer{ 
      white-space: pre; 
      word-break: normal; 
    } 
    .nowrap #editor{ 
      white-space: pre; 
      word-break: normal; 
      overflow-wrap: normal; 
    } 
 
    /* ====== Bottom mini bar (log/status) ====== */ 
    .bottombar{ 
      position:fixed; 
      left:0; right:0; bottom:0; 
      height: calc(var(--bottom-h) + var(--safe-b)); 
      padding: 8px var(--pad) calc(8px + var(--safe-b)) var(--pad); 
      border-top:1px solid var(--line); 
      background: linear-gradient(180deg, rgba(11,18,32,0.2), rgba(11,18,32,0.9) 30%, rgba(11,18,32,1) 100%); 
      z-index: 40; 
    } 
    .logwrap{ 
      border:1px solid var(--line); 
      background: #0a1020; 
      border-radius: var(--radius); 
      padding: 8px 10px; 
      height: 100%; 
      overflow:hidden; 
    } 
    #log{ 
      margin:0; 
      font-size: 12px; 
      line-height: 1.35; 
      color: var(--muted); 
      max-height: 100%; 
      overflow:auto; 
      white-space: pre-wrap; 
      word-break: break-word; 
    } 
 
    /* ====== Dialog ====== */ 
    .overlay{ 
      position:fixed; 
      inset:0; 
      background: rgba(0,0,0,0.55); 
      display:none; 
      align-items:center; 
      justify-content:center; 
      padding: 16px; 
      z-index: 100; 
    } 
    .overlay.open{ display:flex; } 
 
    .dialog{ 
      width: min(520px, 100%); 
      border: 1px solid var(--line); 
      background: rgba(17,24,39,0.98); 
      border-radius: 16px; 
      overflow:hidden; 
      box-shadow: 0 16px 40px rgba(0,0,0,0.45); 
    } 
    .dialog-header{ 
      padding: 12px 14px; 
      border-bottom: 1px solid var(--line); 
      display:flex; 
      align-items:center; 
      justify-content:space-between; 
      gap: 10px; 
    } 
    .dialog-title{ 
      font-size: 14px; 
      color: var(--text); 
      font-weight: 600; 
    } 
    .dialog-body{ 
      padding: 12px 14px; 
    } 
    .dialog-row{ 
      display:flex; 
      gap:10px; 
      align-items:center; 
      margin-bottom:10px; 
    } 
    .dialog-row:last-child{ margin-bottom:0; } 
 
    .input{ 
      width:100%; 
      height:44px; 
      border-radius: 12px; 
      border:1px solid var(--line); 
      background: #0a1020; 
      color: var(--text); 
      padding: 0 10px; 
      font-size: 14px; 
      outline:none; 
      min-width:0; 
    } 
    .select{ 
      width:100%; 
      height:44px; 
      border-radius: 12px; 
      border:1px solid var(--line); 
      background: #0a1020; 
      color: var(--text); 
      padding: 0 10px; 
      font-size: 14px; 
      outline:none; 
    } 
    .toggle{ 
      display:flex; 
      gap:8px; 
      align-items:center; 
      user-select:none; 
      font-size: 13px; 
      color: var(--muted); 
      padding: 10px 12px; 
      min-height:44px; 
      border:1px solid var(--line); 
      background: var(--panel); 
      border-radius: 12px; 
    } 
    .toggle input{ width:18px; height:18px; } 
 
    .btn{ 
      appearance:none; 
      border:1px solid var(--line); 
      background: var(--panel2); 
      color: var(--text); 
      padding: 10px 12px; 
      border-radius: 12px; 
      min-height: 44px; 
      font-size: 14px; 
      white-space:nowrap; 
    } 
    .btn.primary{ border-color: rgba(96,165,250,0.5); } 
    .btn.danger{ border-color: rgba(245,158,11,0.6); } 
    .btn:active{ transform: translateY(1px); } 
 
    .hint{ 
      margin-top: 8px; 
      font-size: 12px; 
      color: var(--muted); 
      line-height: 1.35; 
    } 
    .dialog-section{ 
      margin-top: 12px; 
      padding-top: 12px; 
      border-top: 1px solid var(--line); 
    } 
    .dialog-section:first-child{ 
      margin-top: 0; 
      padding-top: 0; 
      border-top: 0; 
    } 
    .section-title{ 
      font-size: 12px; 
      color: var(--muted); 
      letter-spacing: 0.02em; 
      text-transform: uppercase; 
      margin-bottom: 6px; 
    } 
  </style> 
</head> 
<body> 
 
  <!-- Menu bar --> 
  <div class="menubar" role="navigation" aria-label="Menu Bar"> 
    <div class="menu-group" data-menu="file"> 
      <button class="menu-btn" id="fileBtn" aria-haspopup="true" aria-expanded="false">File</button> 
      <div class="menu-panel" id="fileMenu" role="menu" aria-label="File menu"> 
        <button class="menu-item" id="mNewMemo" role="menuitem">New Memo</button> 
        <button class="menu-item" id="mOpen" role="menuitem">Open…</button> 
        <button class="menu-item" id="mRename" role="menuitem">Rename…</button> 
        <div class="menu-sep"></div> 
        <button class="menu-item" id="mExportSel" role="menuitem">Export Selected…</button> 
        <button class="menu-item" id="mExportAll" role="menuitem">Export All…</button> 
        <button class="menu-item" id="mImport" role="menuitem">Import…</button> 
        <div class="menu-sep"></div> 
        <button class="menu-item" id="mSync" role="menuitem">Sync…</button> 
        <button class="menu-item" id="mVersions" role="menuitem">Versions…</button> 
        <div class="menu-sep"></div> 
        <button class="menu-item" id="mDelete" role="menuitem">Delete Memo…</button> 
      </div> 
    </div> 
 
    <div class="menu-group" data-menu="edit"> 
      <button class="menu-btn" id="editBtn" aria-haspopup="true" aria-expanded="false">Edit</button> 
      <div class="menu-panel" id="editMenu" role="menu" aria-label="Edit menu"> 
        <button class="menu-item" id="mUndo" role="menuitem">Undo</button> 
        <button class="menu-item" id="mRedo" role="menuitem">Redo</button> 
        <div class="menu-sep"></div> 
        <button class="menu-item" id="mFind" role="menuitem">Find…</button> 
        <button class="menu-item" id="mNext" role="menuitem">Next Match</button> 
        <button class="menu-item" id="mPrev" role="menuitem">Previous Match</button> 
        <div class="menu-sep"></div> 
        <button class="menu-item" id="mReplace" role="menuitem">Replace…</button> 
      </div> 
    </div> 
 
    <div class="menu-group" data-menu="view"> 
      <button class="menu-btn" id="viewBtn" aria-haspopup="true" aria-expanded="false">View</button> 
      <div class="menu-panel" id="viewMenu" role="menu" aria-label="View menu"> 
        <button class="menu-item" id="mWrap" role="menuitemcheckbox" aria-checked="true">Wrap</button> 
        <div class="menu-sep"></div> 
        <button class="menu-item" id="mToggleLog" role="menuitem">Toggle Log</button> 
      </div> 
    </div> 
 
    <div class="menubar-right"> 
      <div class="note-title" id="currentTitle">—</div> 
      <div class="status" id="matchStatus">0/0</div> 
      <div class="status" id="saveStatus">Unsaved</div> 
    </div> 
  </div> 
 
  <!-- Editor --> 
  <div class="editor-wrap"> 
    <div class="editor-surface"> 
      <pre id="highlightLayer" aria-hidden="true"></pre> 
      <textarea id="editor" spellcheck="false" autocomplete="off" autocapitalize="off" placeholder="Type your memo here…"></textarea> 
    </div> 
  </div> 
 
  <!-- Bottom log --> 
  <div class="bottombar"> 
    <div class="logwrap"> 
      <pre id="log"></pre> 
    </div> 
  </div> 
 
  <!-- Open dialog --> 
  <div class="overlay" id="openOverlay" aria-hidden="true"> 
    <div class="dialog" role="dialog" aria-label="Open Memo"> 
      <div class="dialog-header"> 
        <div class="dialog-title">Open Memo</div> 
        <button class="btn" data-close="openOverlay">Close</button> 
      </div> 
      <div class="dialog-body"> 
        <div class="dialog-row"> 
          <select id="noteSelect" class="select" aria-label="Select memo"></select> 
        </div> 
        <div class="dialog-row"> 
          <button class="btn primary" id="openApplyBtn">Open</button> 
          <button class="btn primary" id="newNoteBtn">New Memo</button> 
        </div> 
        <div class="hint">Sorted by most recently updated.</div> 
      </div> 
    </div> 
  </div> 
 
  <!-- Rename dialog --> 
  <div class="overlay" id="renameOverlay" aria-hidden="true"> 
    <div class="dialog" role="dialog" aria-label="Rename Memo"> 
      <div class="dialog-header"> 
        <div class="dialog-title">Rename Memo</div> 
        <button class="btn" data-close="renameOverlay">Close</button> 
      </div> 
      <div class="dialog-body"> 
        <div class="dialog-row"> 
          <input id="titleInput" class="input" type="text" placeholder="Title" /> 
        </div> 
        <div class="dialog-row"> 
          <button class="btn primary" id="renameBtn">Rename</button> 
          <button class="btn danger" id="deleteBtn">Delete</button> 
        </div> 
      </div> 
    </div> 
  </div> 
 
  <!-- Find dialog --> 
  <div class="overlay" id="findOverlay" aria-hidden="true"> 
    <div class="dialog" role="dialog" aria-label="Find"> 
      <div class="dialog-header"> 
        <div class="dialog-title">Find</div> 
        <button class="btn" data-close="findOverlay">Close</button> 
      </div> 
      <div class="dialog-body"> 
        <div class="dialog-row"> 
          <input id="findInput" class="input" type="text" placeholder="Search (Enter = next / Shift+Enter = previous)" /> 
        </div> 
        <div class="dialog-row"> 
          <label class="toggle"><input id="regexToggle" type="checkbox" /> Regex</label> 
          <label class="toggle"><input id="caseToggle" type="checkbox" /> Case sensitive</label> 
        </div> 
        <div class="dialog-row"> 
          <button class="btn" id="prevBtn">Previous</button> 
          <button class="btn primary" id="nextBtn">Next</button> 
        </div> 
      </div> 
    </div> 
  </div> 
 
  <!-- Replace dialog --> 
  <div class="overlay" id="replaceOverlay" aria-hidden="true"> 
    <div class="dialog" role="dialog" aria-label="Replace"> 
      <div class="dialog-header"> 
        <div class="dialog-title">Replace</div> 
        <button class="btn" data-close="replaceOverlay">Close</button> 
      </div> 
      <div class="dialog-body"> 
        <div class="dialog-row"> 
          <input id="replaceInput" class="input" type="text" placeholder="Replacement text" /> 
        </div> 
        <div class="dialog-row"> 
          <button class="btn" id="replaceBtn">Replace</button> 
          <button class="btn danger" id="replaceAllBtn">Replace All</button> 
          <button class="btn" id="clearBtn">Clear Text</button> 
        </div> 
        <div class="hint">Replace affects the current match only; Replace All affects every match.</div> 
      </div> 
    </div> 
  </div> 

  <!-- Sync dialog --> 
  <div class="overlay" id="syncOverlay" aria-hidden="true"> 
    <div class="dialog" role="dialog" aria-label="Sync"> 
      <div class="dialog-header"> 
        <div class="dialog-title">Sync</div> 
        <button class="btn" data-close="syncOverlay">Close</button> 
      </div> 
      <div class="dialog-body"> 
        <div class="dialog-section"> 
          <div class="section-title">Server</div> 
          <div class="dialog-row"> 
            <input id="syncEndpointInput" class="input" type="url" placeholder="Server endpoint (e.g., https://example.com)" /> 
          </div> 
        </div> 
        <div class="dialog-section"> 
          <div class="section-title">Account</div> 
          <div class="dialog-row"> 
            <input id="syncUsernameInput" class="input" type="text" autocomplete="username" placeholder="Username" /> 
          </div> 
          <div class="dialog-row"> 
            <input id="syncPasswordInput" class="input" type="password" autocomplete="current-password" placeholder="Password" /> 
          </div> 
          <div class="dialog-row"> 
            <button class="btn" id="syncRegisterBtn">Register</button> 
            <button class="btn primary" id="syncLoginBtn">Login</button> 
          </div> 
          <div class="hint">Register creates a new user. Login will fetch a new token.</div> 
        </div> 
        <div class="dialog-section"> 
          <div class="section-title">Token</div> 
          <div class="dialog-row"> 
            <input id="syncTokenInput" class="input" type="password" placeholder="Auth token (Bearer)" /> 
          </div> 
          <div class="dialog-row"> 
            <button class="btn" id="syncSaveBtn">Save Settings</button> 
            <button class="btn primary" id="syncNowBtn">Sync Now</button> 
          </div> 
        </div> 
        <div class="hint" id="syncStatus"></div> 
        <div class="hint">Sync is manual. Offline usage remains the default.</div> 
      </div> 
    </div> 
  </div> 

  <!-- Versions dialog --> 
  <div class="overlay" id="versionsOverlay" aria-hidden="true"> 
    <div class="dialog" role="dialog" aria-label="Versions"> 
      <div class="dialog-header"> 
        <div class="dialog-title">Versions</div> 
        <button class="btn" data-close="versionsOverlay">Close</button> 
      </div> 
      <div class="dialog-body"> 
        <div class="dialog-row"> 
          <select id="versionSelect" class="select" aria-label="Select version"></select> 
        </div> 
        <div class="dialog-row"> 
          <button class="btn primary" id="versionRestoreBtn">Restore</button> 
        </div> 
        <div class="hint">Restoring creates a new version from current content.</div> 
      </div> 
    </div> 
  </div> 
 
  <!-- Hidden import input --> 
  <input id="importFile" type="file" accept="application/json,.json" style="display:none" /> 
 
<script type="module" src="./js/app.js"></script>
 
</body> 
</html> 
